## 作者:VK
### 更新时间：2020-07-22

## 极简安装步骤

在你的项目根目录执行npm命令：npm i vk-unicloud-page 进行安装

1. `npm`方式安装
```js
npm i vk-unicloud-page
```

2. `main.js`引入vk-unicloud-page库
```js
// main.js
import vk from 'vk-unicloud-page';
Vue.use(vk);
```

# this.vk.callFunction函数的参数说明
```html
/**
 * 云函数请求封装 - 统一入口
 * @description 通过云函数路由，1个云函数实现多个云函数的效果。
 * @params {String}   url       请求路径，该路径实为router云函数的service目录下的路径
 * @params {Object}   data      请求参数
 * @params {String}   title     遮罩层提示语，为空或不传则代表不显示遮罩层。
 * @params {Boolean}  isRequest 是否使用云函数url化地址访问云函数，默认false
 * @params {Boolean}  noAlert   为true代表请求错误时，不会有弹窗提示。默认为false
 * @params {Function} success   请求成功时，执行的回调函数
 * @params {Function} fail      请求失败时，执行的回调函数
 * @params {Function} complete  无论请求成功与否，都会执行的回调函数
 */
```


# 普通方式调用云函数示例

```html

this.vk.callFunction({
	url: 'user/kh/setAvatar',
	title:'请求中...',
	data:{
		avatar: "https://xxxxxxx.jpg"
	},
	success(data) {
		// 修改成功
	}
});

```

# 云函数url化方式调用云函数示例
isRequest:true 代表使用url访问云函数，一般用于PC后台管理页面使用

```html
this.vk.callFunction({
	url: 'user/kh/setAvatar',
	title:'请求中...',
	isRequest:true,
	data:{
		avatar: "https://xxxxxxx.jpg"
	},
	success(data) {
		// 修改成功
	}
});

```


# 注意：云函数url化方式调用需要配置你的云函数url路径地址
`main.js` 在代码`Vue.use(vk); `的下方添加
```html
// 自定义云函数路由配置
Vue.prototype.vk.callFunctionUtil.setConfig({
    // 云函数路由（主函数url化地址）
    functionPath:"https://xxxxx.bspapp.com/http/router",
    // 云函数路由（开发测试函数url化地址）
    testFunctionPath:"https://xxxxx.bspapp.com/http/router-test",
});

```


# 前端非法token拦截器
`main.js` 在代码`Vue.use(vk); `的下方添加
```html
// 自定义token拦截器
Vue.prototype.vk.callFunctionUtil.interceptor.login = (obj = {}) =>{
	let {params, res} = obj;
	// 下方代码可自己修改，写成你自己的逻辑处理。
	if(!params.noAlert){
		Vue.prototype.vk.alert(res.result.msg);
	}
	console.log("跳自己的登录页面");
	// 上方代码可自己修改，写成你自己的逻辑处理。
};
```

# 如何切换正式环境和开发环境
`main.js` 在代码`Vue.use(vk); `的下方添加
```html
// 自定义云函数路由配置
Vue.prototype.vk.callFunctionUtil.setConfig({
	// 是否开启测试环境，true：使用测试环境，false：使用正式环境，默认true
  isTest:true
});

```
